[
  {
    "objectID": "colophon.html",
    "href": "colophon.html",
    "title": "Colophon",
    "section": "",
    "text": "Colophon\nThis project would not be possible without the tireless work of many free-software developers. Many thanks for all your work.\nR Core Team (2023). R: A Language and Environment for Statistical Computing. R Foundation for Statistical Computing, Vienna, Austria. https://www.R-project.org/.\nQuarto from Posit / RStudio.\ngithub/juba’s great quarto extension bookup-html"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Introduction",
    "section": "",
    "text": "Hello and welcome to this project in which I tried to explain and present my analysis and thoughts around the interview task that I got from Ivan.\nI hope you find it interesting and I am looking forward to presenting it and discussing it with you.\n\n\n\n\n\n\nTask overview\n\n\n\nHi, can you provide me with an in depth analysis of our marketing efforts, based on the data provided in the attachment.\nWe’d like to focus our activities on markets which we can easily scale while keeping long term profitability.\nOverview about our imaginary client:\nClient is a global passenger transfer company which focuses on short distance transport. Their customers are mostly people travelling for holidays with family, but around 15% of business also falls in the business travel category.\nDue to recent market changes they are looking into optimising their marketing efforts in order to overtake higher market share in the future; currently their main markets are US, UK, Argentina, and South Korea where they are market leaders with 30%+ market share\nTheir activities are in some markets mostly offline, while in others are just online.\n\n\nThe main goals are:\n\nscale markets easily\nwhile keeping long term profitability\nin order to gain higher market share\n\n\n\nWhile one of the main points is around keeping profitability no data on marketing spend was provided which is essential in order to determine this (for the paid channels like cpc).\nNevertheless, the data provided contained many interesting insights already - and besides that, I think it should not be too hard to also add this aspect to the existing analysis."
  },
  {
    "objectID": "index.html#callout",
    "href": "index.html#callout",
    "title": "Introduction",
    "section": "",
    "text": "While one of the main points is around keeping profitability no data on marketing spend was provided which is essential in order to determine this (for the paid channels like cpc).\nNevertheless, the data provided contained many interesting insights already - and besides that, I think it should not be too hard to also add this aspect to the existing analysis."
  },
  {
    "objectID": "country.html",
    "href": "country.html",
    "title": "Country",
    "section": "",
    "text": "In this section I will try to look at the medium_country data from a higher level - aggregated per country. I would like to see first an intro to the data, which countries drive the most users and revenue, try to identify a subset on which I can focus the analysis and lastly - try to give an advice to our client by just looking at this level.\nThe first section is exploring the data - feel free to jump to the more interesting parts:\n\nA look into which countries could simultaneously be good and converting traffic and having high revenue per transaction\nKind of “thought experiment” on how to gain better marketing traction just by looking at the current situation\n\n\n\n\n\nCode\nlibrary(\"here\")\nlibrary(\"fs\")\nlibrary(\"DT\")\nlibrary(\"janitor\")\nlibrary(\"scales\")\nlibrary(\"tidyverse\")\n\ndata_dir &lt;- \"data\"\nfile_name &lt;- \"medium_country.csv\"\n\nmedium_country_raw &lt;- read_csv(\n  path_join(c(here(), data_dir, file_name)),\n  skip = 6\n) |&gt; \n  clean_names()\n\nn_countries_total &lt;- medium_country_raw$country |&gt; unique() |&gt; length()\n\n\nThe source file contains data on 240 countries in total and e.g. looks like this for Croatia\n\n\nCode\nmedium_country_raw |&gt; \n  filter(country == \"Croatia\") |&gt; \n  arrange(desc(revenue)) |&gt; \n  datatable()\n\n\n\n\n\n\n\nThe data is on country / medium level so I would like to collapse it down to just the country level grouping and compute some additional high-level metrics.\n\n\nCode\nby_country &lt;- \n  medium_country_raw |&gt; \n  group_by(country) |&gt; \n  summarise(\n    # summable-metrics\n    across(\n      c(users, new_users, sessions, transactions, revenue),\n      sum\n    ),\n    # take means for the rates, shares, durations\n    across(\n      c(bounce_rate, pages_session, avg_session_duration, ecommerce_conversion_rate),\n      mean\n    )\n  ) |&gt; \n  ungroup() |&gt; \n  # calculate new columns\n  mutate(\n    revenue_per_transaction = revenue / transactions,\n    new_users_share = new_users / users\n  )\n\n\nby_country |&gt;\n  filter(country == \"Croatia\") |&gt;\n  mutate(across(is.numeric, ~ round(.x, 3))) |&gt; \n  datatable(options = list(dom = 't'))\n\n\n\n\n\n\n\n\n\n\nAre there countries with very very low volume of users, transactions or revenue ?\nI would pick users, transactions, revenue as most important metrics and look at their quantiles.\n\n\nCode\nby_country |&gt; \n  select(users, transactions, revenue) |&gt; \n  map(quantile, probs = seq(0, 1, 0.05))\n\n\n$users\n        0%         5%        10%        15%        20%        25%        30% \n      2.00      74.50     385.00     568.50     974.80    1336.00    1786.10 \n       35%        40%        45%        50%        55%        60%        65% \n   2479.10    3462.40    4153.70    7831.00   11915.15   18281.60   31478.55 \n       70%        75%        80%        85%        90%        95%       100% \n  45452.50   72587.00  121966.20  256002.05  377302.90  824808.15 8390796.00 \n\n$transactions\n       0%        5%       10%       15%       20%       25%       30%       35% \n     0.00      2.00      7.90     11.70     23.80     33.00     42.80     58.65 \n      40%       45%       50%       55%       60%       65%       70%       75% \n    83.20    106.55    168.00    274.25    395.40    642.50   1120.60   1936.00 \n      80%       85%       90%       95%      100% \n  3442.80   6892.75  12443.30  21468.00 293169.00 \n\n$revenue\n          0%           5%          10%          15%          20%          25% \n       0.000     1010.094     3536.412     6083.276    11729.995    18284.208 \n         30%          35%          40%          45%          50%          55% \n   25438.798    34884.987    47421.774    58671.711    78038.093   111281.571 \n         60%          65%          70%          75%          80%          85% \n  156957.122   234950.814   385850.104   701653.123   901895.735  2206571.170 \n         90%          95%         100% \n 3484899.314  5879185.640 83228820.262 \n\n\n\nabout ~20% of the countries have less than ~1000 users\nin terms of transactions it looks like ~45% of the countries have less than ~100 transactions\nin terms of revenue taking ~20,000€ as cutoff point would remove ~25% of the countries\n\nArguably these are random cut-off points that I just picked and make sense to me - such choices are definitely debatable. My goal is to reduce the noise in the data and focus on the bigger players where potential changes in the marketing strategy would make sense (e.g. compared to low volume countries where suggesting changes in the marketing strategy would have limited impact).\nBased on this quick checks I am inclined to set some simple rules like\nrevenue &lt;= 20,000  or  users &lt;= 1,000  or  transactions &lt;= 100\nI can go back to revise this later if needed, in case there is still lots of noise or conversely i am missing some granularity, as well as look more into the lower revenue countries to see if there is something to be said for them separately. (TODO: link to appendix for this check ?)\nThe potentially-to-be-removed countries seem to be indeed small countries.\n\n\nCode\nby_country |&gt;\n  filter(\n    (revenue &lt;= 20000) | (users &lt;= 1000) | (transactions &lt;= 100)\n  ) |&gt;\n  select(country, users:revenue) |&gt; \n  arrange(desc(revenue)) |&gt; \n  datatable()\n\n\n\n\n\n\n\nDoing a qualitative check along this list confirms that these seems to be small and not so interesting countries indeed - either in terms of volume of traffic or very small number of transactions.\nHow many countries will be removed with this rule ? How much of the revenue do they contribute to ?\n\n\nCode\nby_country |&gt; \n  mutate(\n    too_low_volume = {\n      (revenue &lt;= 20000) | (users &lt;= 1000) | (transactions &lt;= 100)\n    }\n  ) |&gt; \n  group_by(too_low_volume) |&gt; \n  summarise(\n    n_countries = n(),\n    revenue = sum(revenue)\n  ) |&gt; \n  ungroup() |&gt; \n  mutate(\n    perc_revenue   = round(revenue / sum(revenue), 3),\n    perc_countries = round(n_countries / sum(n_countries), 3)\n  ) |&gt; \n  datatable(options = list(dom = 't'))\n\n\n\n\n\n\n\nI would be removing 104 countries ~43% of the total number but half a percent in terms of revenue. This seems ok to me (for now - perhaps to be revised later).\n\n\n\n\nCode\nby_country &lt;- by_country |&gt; \n  filter(\n    (revenue &gt; 20000) & (users &gt; 1000) & (transactions &gt; 100)\n  )\n\n\n\n\n\n\nI’m curious to see how the business of the client looks like more visually. I would like to plot the world in terms of buckets of revenue (split roughly and evenly in 7 buckets) in order to see how the “concentration” looks like.\n\n\nCode\nlibrary(\"rworldmap\")\n\n# split revenue into buckets\nby_country &lt;- \n  by_country |&gt; \n  mutate(revenue_ntile = ntile(revenue, n = 7))\n\n# map\nby_country_map &lt;- joinCountryData2Map(\n  by_country,\n  joinCode = \"NAME\",\n  nameJoinColumn = \"country\"\n)\n\n\n125 codes from your data successfully matched countries in the map\n11 codes from your data failed to match with a country code in the map\n118 codes from the map weren't represented in your data\n\n\nCode\ncolours &lt;- RColorBrewer::brewer.pal(11, \"BrBG\")[c(2:5, 9:10)]\n\nmapCountryData(\n  by_country_map,\n  nameColumnToPlot = \"revenue_ntile\",\n  numCats = 5,\n  colourPalette = colours,\n  mapTitle = \"Map in terms of revenue buckets\"\n)\n\n\n\n\n\n\nWestern Europe, Russia, Japan, Australia, North Americas and Brazil are top tiers\nThe middle tiers would be China, India, Argentina, Chile, South Africa, Turkey\nBottom tiers would be most of North Africa and some of the Middle East\n\nI expect the map to look very similar if we plot # of users, sessions or transactions instead.\nOne interesting thing to notice here is that the briefing from the client mentions that Argentina is a top market country with 30%+ market shere, however looking at the map it is a tier-2 country.\n\n\nCode\nhues::swatch(colours)"
  },
  {
    "objectID": "country.html#data-exploration",
    "href": "country.html#data-exploration",
    "title": "Country",
    "section": "",
    "text": "Code\nlibrary(\"here\")\nlibrary(\"fs\")\nlibrary(\"DT\")\nlibrary(\"janitor\")\nlibrary(\"scales\")\nlibrary(\"tidyverse\")\n\ndata_dir &lt;- \"data\"\nfile_name &lt;- \"medium_country.csv\"\n\nmedium_country_raw &lt;- read_csv(\n  path_join(c(here(), data_dir, file_name)),\n  skip = 6\n) |&gt; \n  clean_names()\n\nn_countries_total &lt;- medium_country_raw$country |&gt; unique() |&gt; length()\n\n\nThe source file contains data on 240 countries in total and e.g. looks like this for Croatia\n\n\nCode\nmedium_country_raw |&gt; \n  filter(country == \"Croatia\") |&gt; \n  arrange(desc(revenue)) |&gt; \n  datatable()\n\n\n\n\n\n\n\nThe data is on country / medium level so I would like to collapse it down to just the country level grouping and compute some additional high-level metrics.\n\n\nCode\nby_country &lt;- \n  medium_country_raw |&gt; \n  group_by(country) |&gt; \n  summarise(\n    # summable-metrics\n    across(\n      c(users, new_users, sessions, transactions, revenue),\n      sum\n    ),\n    # take means for the rates, shares, durations\n    across(\n      c(bounce_rate, pages_session, avg_session_duration, ecommerce_conversion_rate),\n      mean\n    )\n  ) |&gt; \n  ungroup() |&gt; \n  # calculate new columns\n  mutate(\n    revenue_per_transaction = revenue / transactions,\n    new_users_share = new_users / users\n  )\n\n\nby_country |&gt;\n  filter(country == \"Croatia\") |&gt;\n  mutate(across(is.numeric, ~ round(.x, 3))) |&gt; \n  datatable(options = list(dom = 't'))"
  },
  {
    "objectID": "country.html#low-volume-countries",
    "href": "country.html#low-volume-countries",
    "title": "Country",
    "section": "",
    "text": "Are there countries with very very low volume of users, transactions or revenue ?\nI would pick users, transactions, revenue as most important metrics and look at their quantiles.\n\n\nCode\nby_country |&gt; \n  select(users, transactions, revenue) |&gt; \n  map(quantile, probs = seq(0, 1, 0.05))\n\n\n$users\n        0%         5%        10%        15%        20%        25%        30% \n      2.00      74.50     385.00     568.50     974.80    1336.00    1786.10 \n       35%        40%        45%        50%        55%        60%        65% \n   2479.10    3462.40    4153.70    7831.00   11915.15   18281.60   31478.55 \n       70%        75%        80%        85%        90%        95%       100% \n  45452.50   72587.00  121966.20  256002.05  377302.90  824808.15 8390796.00 \n\n$transactions\n       0%        5%       10%       15%       20%       25%       30%       35% \n     0.00      2.00      7.90     11.70     23.80     33.00     42.80     58.65 \n      40%       45%       50%       55%       60%       65%       70%       75% \n    83.20    106.55    168.00    274.25    395.40    642.50   1120.60   1936.00 \n      80%       85%       90%       95%      100% \n  3442.80   6892.75  12443.30  21468.00 293169.00 \n\n$revenue\n          0%           5%          10%          15%          20%          25% \n       0.000     1010.094     3536.412     6083.276    11729.995    18284.208 \n         30%          35%          40%          45%          50%          55% \n   25438.798    34884.987    47421.774    58671.711    78038.093   111281.571 \n         60%          65%          70%          75%          80%          85% \n  156957.122   234950.814   385850.104   701653.123   901895.735  2206571.170 \n         90%          95%         100% \n 3484899.314  5879185.640 83228820.262 \n\n\n\nabout ~20% of the countries have less than ~1000 users\nin terms of transactions it looks like ~45% of the countries have less than ~100 transactions\nin terms of revenue taking ~20,000€ as cutoff point would remove ~25% of the countries\n\nArguably these are random cut-off points that I just picked and make sense to me - such choices are definitely debatable. My goal is to reduce the noise in the data and focus on the bigger players where potential changes in the marketing strategy would make sense (e.g. compared to low volume countries where suggesting changes in the marketing strategy would have limited impact).\nBased on this quick checks I am inclined to set some simple rules like\nrevenue &lt;= 20,000  or  users &lt;= 1,000  or  transactions &lt;= 100\nI can go back to revise this later if needed, in case there is still lots of noise or conversely i am missing some granularity, as well as look more into the lower revenue countries to see if there is something to be said for them separately. (TODO: link to appendix for this check ?)\nThe potentially-to-be-removed countries seem to be indeed small countries.\n\n\nCode\nby_country |&gt;\n  filter(\n    (revenue &lt;= 20000) | (users &lt;= 1000) | (transactions &lt;= 100)\n  ) |&gt;\n  select(country, users:revenue) |&gt; \n  arrange(desc(revenue)) |&gt; \n  datatable()\n\n\n\n\n\n\n\nDoing a qualitative check along this list confirms that these seems to be small and not so interesting countries indeed - either in terms of volume of traffic or very small number of transactions.\nHow many countries will be removed with this rule ? How much of the revenue do they contribute to ?\n\n\nCode\nby_country |&gt; \n  mutate(\n    too_low_volume = {\n      (revenue &lt;= 20000) | (users &lt;= 1000) | (transactions &lt;= 100)\n    }\n  ) |&gt; \n  group_by(too_low_volume) |&gt; \n  summarise(\n    n_countries = n(),\n    revenue = sum(revenue)\n  ) |&gt; \n  ungroup() |&gt; \n  mutate(\n    perc_revenue   = round(revenue / sum(revenue), 3),\n    perc_countries = round(n_countries / sum(n_countries), 3)\n  ) |&gt; \n  datatable(options = list(dom = 't'))\n\n\n\n\n\n\n\nI would be removing 104 countries ~43% of the total number but half a percent in terms of revenue. This seems ok to me (for now - perhaps to be revised later).\n\n\n\n\nCode\nby_country &lt;- by_country |&gt; \n  filter(\n    (revenue &gt; 20000) & (users &gt; 1000) & (transactions &gt; 100)\n  )"
  },
  {
    "objectID": "country.html#revenue-map",
    "href": "country.html#revenue-map",
    "title": "Country",
    "section": "",
    "text": "I’m curious to see how the business of the client looks like more visually. I would like to plot the world in terms of buckets of revenue (split roughly and evenly in 7 buckets) in order to see how the “concentration” looks like.\n\n\nCode\nlibrary(\"rworldmap\")\n\n# split revenue into buckets\nby_country &lt;- \n  by_country |&gt; \n  mutate(revenue_ntile = ntile(revenue, n = 7))\n\n# map\nby_country_map &lt;- joinCountryData2Map(\n  by_country,\n  joinCode = \"NAME\",\n  nameJoinColumn = \"country\"\n)\n\n\n125 codes from your data successfully matched countries in the map\n11 codes from your data failed to match with a country code in the map\n118 codes from the map weren't represented in your data\n\n\nCode\ncolours &lt;- RColorBrewer::brewer.pal(11, \"BrBG\")[c(2:5, 9:10)]\n\nmapCountryData(\n  by_country_map,\n  nameColumnToPlot = \"revenue_ntile\",\n  numCats = 5,\n  colourPalette = colours,\n  mapTitle = \"Map in terms of revenue buckets\"\n)\n\n\n\n\n\n\nWestern Europe, Russia, Japan, Australia, North Americas and Brazil are top tiers\nThe middle tiers would be China, India, Argentina, Chile, South Africa, Turkey\nBottom tiers would be most of North Africa and some of the Middle East\n\nI expect the map to look very similar if we plot # of users, sessions or transactions instead.\nOne interesting thing to notice here is that the briefing from the client mentions that Argentina is a top market country with 30%+ market shere, however looking at the map it is a tier-2 country.\n\n\nCode\nhues::swatch(colours)"
  },
  {
    "objectID": "country.html#conclusions-from-this-part",
    "href": "country.html#conclusions-from-this-part",
    "title": "Country",
    "section": "Conclusions from this part",
    "text": "Conclusions from this part\n\n\nCode\nby_country |&gt; \n  filter(country != \"(not set)\") |&gt; \n  arrange(\n    desc(revenue),\n    desc(users), \n    desc(ecommerce_conversion_rate),\n    desc(transactions),\n  ) |&gt; \n  head(12)\n\n\n# A tibble: 12 × 13\n   country          users new_users sessions transactions   revenue bounce_rate\n   &lt;chr&gt;            &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;        &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt;\n 1 United States  8390796   8036542 10422761       184111 58083012.       0.634\n 2 United Kingdom 2490527   2236895  3739529       111107 32949311.       0.592\n 3 France         1857786   1640029  2725570        63998 18256288.       0.489\n 4 Germany        1889501   1687855  2845711        48819 12906843.       0.593\n 5 Spain          1244829   1066433  2002153        49919 12781152.       0.585\n 6 Russia          970367    906921  1399275        31119  7633702.       0.573\n 7 Denmark         473916    425928   717848        24560  7626318.       0.523\n 8 Italy           886314    761165  1395796        38606  7580001.       0.579\n 9 Sweden          682395    612170  1060302        27527  7574207.       0.445\n10 Mexico          824797    735869  1203606        23593  7397461.       0.547\n11 Japan           385510    348249   579486        15707  5993928.       0.502\n12 Australia       359405    328222   513290        12309  5873147.       0.525\n# ℹ 6 more variables: pages_session &lt;dbl&gt;, avg_session_duration &lt;dbl&gt;,\n#   ecommerce_conversion_rate &lt;dbl&gt;, revenue_per_transaction &lt;dbl&gt;,\n#   new_users_share &lt;dbl&gt;, revenue_ntile &lt;int&gt;"
  },
  {
    "objectID": "country.html#high",
    "href": "country.html#high",
    "title": "Country",
    "section": "High",
    "text": "High\nCountries that convert traffic and have high revenue per transaction are very valuable. In case the traffic is low in such a country - then a suggestion could be to scale up marketing and bring in more traffic.\nI would take a look at:\n\ncountries that convert traffic better than half of the countries in the list\ntheir revenue per transaction is above the average level\n\n\n\nCode\nhigh_conv_rate_and_valuable &lt;- by_country |&gt; \n  filter(country != \"(not set)\", transactions &gt; 2000) |&gt; \n  mutate(\n    diff_to_mean_revenue_per_transaction = {\n      as.integer(revenue_per_transaction - mean(revenue_per_transaction))\n    },\n    ecommerce_conversion_rate = percent_format(accuracy = 0.01,)(ecommerce_conversion_rate),\n    revenue_per_transaction = as.integer(revenue_per_transaction),\n    # country has better ecomm.conv.rate than 50% of the others\n    is_top_converting_country = percent_rank(desc(ecommerce_conversion_rate)) &lt;= 0.5,\n    # country has above average revenue per transaction\n    is_rev_per_trans_higher_than_avg = diff_to_mean_revenue_per_transaction &gt; 0\n  ) |&gt; \n  select(\n    country,\n    ecommerce_conversion_rate,\n    is_top_converting_country,\n    revenue_per_transaction,\n    diff_to_mean_revenue_per_transaction,\n    is_rev_per_trans_higher_than_avg,\n    users,\n    new_users,\n    transactions,\n    revenue,\n    sessions\n  ) |&gt; \n  filter( is_top_converting_country, is_rev_per_trans_higher_than_avg ) |&gt; \n  arrange(desc(ecommerce_conversion_rate), desc(revenue_per_transaction))\n\ndatatable(high_conv_rate_and_valuable)"
  },
  {
    "objectID": "country.html#conv-rate-rev-per-transaction-conclusions",
    "href": "country.html#conv-rate-rev-per-transaction-conclusions",
    "title": "Country",
    "section": "Conclusion for this part",
    "text": "Conclusion for this part\nThe above list of countries is an interesting subset of all the countries in terms of good converting and high revenue traffic. Taking New Zealand and Japan as example:\n\nJapan is one of the 3 countries in this list with conv.rate higher than 1% while also having revenue per transaction that is 91€ higher than the average\nNew Zealand is slightly below with conv.rate of 0.94% but it’s revenue per transaction is 230€ higher than the average\n\nIt would make sense to invest in marketing in these countries as the traffic is very valuable and very likely to convert.\n\n\nCode\nhigh_conv_rate_and_valuable_candidates &lt;- high_conv_rate_and_valuable |&gt; \n  select(country) |&gt;\n  mutate(good_conversion_and_high_value = T)\n\nfilename &lt;- \"high_conv_rate_and_valuable_candidates.csv\"\n\nhigh_conv_rate_and_valuable_candidates |&gt; \n  write_csv(path_join(c(here(), data_dir, filename)))"
  },
  {
    "objectID": "country.html#low",
    "href": "country.html#low",
    "title": "Country",
    "section": "Low",
    "text": "Low\nA small side note could be to inspect the countries with the lowest conv.rate that do bring lots of users to the website. Perhaps by investing some money into improving the quality of service in these countries could bring lots of gain due to the potentially gaining many new paying customers that are currently for some reason not trusting/buying the service.\n\n\nCode\nlow_conv_rate_high_traffic &lt;- by_country |&gt; \n  filter(country != \"(not set)\", transactions &gt; 2000) |&gt; \n  mutate(\n    diff_to_mean_revenue_per_transaction = {\n      as.integer(revenue_per_transaction - mean(revenue_per_transaction))\n    },\n    ecommerce_conversion_rate = percent_format(accuracy = 0.01,)(ecommerce_conversion_rate),\n    revenue_per_transaction = as.integer(revenue_per_transaction),\n    # country has better ecomm.conv.rate than 50% of the others\n    is_bottom_converting_country = percent_rank(desc(ecommerce_conversion_rate)) &gt;= 0.75,\n    # country has above average revenue per transaction\n    is_rev_per_trans_higher_than_avg = diff_to_mean_revenue_per_transaction &gt; 0\n  ) |&gt; \n  select(\n    country,\n    ecommerce_conversion_rate,\n    is_bottom_converting_country,\n    revenue_per_transaction,\n    diff_to_mean_revenue_per_transaction,\n    is_rev_per_trans_higher_than_avg,\n    users,\n    new_users,\n    transactions,\n    revenue,\n    sessions\n  ) |&gt; \n  filter( is_bottom_converting_country ) |&gt; \n  arrange(desc(users)) |&gt; \n  head(3)\n\ndatatable(low_conv_rate_high_traffic)\n\n\n\n\n\n\n\nTake for example Lithuania - it brings a lot of new users to the website yet it converts / transacts very badly - this could be indication of some problem with the service ? It could be worth exploring because of the potential for gaining new transacting customers easily."
  },
  {
    "objectID": "conversion_paths.html",
    "href": "conversion_paths.html",
    "title": "Conversion paths",
    "section": "",
    "text": "In this section I plan to look at the conversion paths data export into more detail. The one big question waiting to be asked and answered with this kind of file export is - building a Markov model on the conversion paths and investigating the resulting network:\n\nhow does it compare against the simpler heuristics like last touch / first touch ?\n\nhere in particular it would be interesting to compare against the last touch as that would actually give us a eye-to-eye comparison of these 2 types of attribution models\ngiven that I have already seen the last-non-direct attributed view on the data from the country_medium.csv file, I am curious how would the referral medium perform in this view\n\nwhat do the Removal Effects say i.e. according to the Markov model - what % of the conversions would not have happened - had we removed a certain medium\n\nhere also in particular it would be interesting to see how do the main contributors from the country/medium analysis fare against each other i.e. how do referral, (none), organic, cpc do in terms of their removal effects ? are some over-/under- valued ?\n\n\nWhile these are the major points I expect to come out of this section, one other interesting thing could be\n\ncheck the distribution of the conversion path lenghts; what is the most usual length of touchpoints that customers go through before converting ?\n\nThe first section explores a bit the data and does some cleaning - feel free to jump to the more interesting parts:\n\nA look at the average number of steps it takes for a client to make a conversion on the client’s website\nExploring the results from the Markov model, the transition probabilities, the removal effects and a comparison of heuristic vs. markov model conversion attribution results"
  },
  {
    "objectID": "conversion_paths.html#conversions-are-all-1s",
    "href": "conversion_paths.html#conversions-are-all-1s",
    "title": "Conversion paths",
    "section": "Conversions are all 1s ?",
    "text": "Conversions are all 1s ?\nAre all conversions a single 1 or is there variety in the data ?\n\n\n\n\n\n\n\nSeems like most of conv. are 1s but perhaps there are some other values ?\n\n\nCode\nsummary(conv_paths_raw$conversions)\n\n\n    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. \n     1.0      1.0      1.0     36.4      1.0 446425.0 \n\n\nThe summary shows that most are 1s but there are other values at the right tail end of the distribution. There are no 0 conversions, which is good.\nI can convert them to integer numbers.\n\n\nCode\nconv_paths &lt;- conv_paths_raw |&gt;\n  mutate(conversions = as.integer(conversions))"
  },
  {
    "objectID": "conversion_paths.html#value-always-in-eur",
    "href": "conversion_paths.html#value-always-in-eur",
    "title": "Conversion paths",
    "section": "Value always in EUR ?",
    "text": "Value always in EUR ?\nSeparate the EUR from the numeric value and split them separately to check how they look like.\n\n\nCode\nconv_paths &lt;- conv_paths |&gt;\n  mutate(\n    value_splits = str_split(value, \" \", n = 2),\n    currency = map_chr(value_splits, first),\n    value = {\n      map_chr(value_splits, nth, n = 2) |&gt;\n        str_remove_all(\",\") |&gt;\n        parse_number()\n    },\n    value_splits = NULL\n  )\n\n\nIs the currency of the value always in EUR ?\n\n\nCode\nconv_paths |&gt; count(currency)\n\n\n# A tibble: 1 × 2\n  currency     n\n  &lt;chr&gt;    &lt;int&gt;\n1 EUR      37332\n\n\nYes, great I can safely drop this.\n\n\nCode\nconv_paths &lt;- conv_paths |&gt; select(-currency)\n\n\nHow does value look like ?\n\n\nCode\n# 1\nsummary(conv_paths$value)\n\n\n     Min.   1st Qu.    Median      Mean   3rd Qu.      Max. \n        0        93       229     10665       548 127337281 \n\n\nThe summary shows that value does have 0s , half of the data values are &lt;= 229 and the right end of the tail looks like it is quite long / heavy.\nHow does this right-end of the tail look like ?\n\n\nCode\nquantile(conv_paths$value, seq(0.9, 1, 0.01)) |&gt; comma()\n\n\n          90%           91%           92%           93%           94% \n      \"1,259\"       \"1,377\"       \"1,519\"       \"1,723\"       \"1,993\" \n          95%           96%           97%           98%           99% \n      \"2,370\"       \"2,930\"       \"3,889\"       \"6,498\"      \"15,920\" \n         100% \n\"127,337,281\" \n\n\nLooks like we have suuuper heavy tail with some extreme values in the top percentiles.\nI would like to see the top 10 medium paths ordered by descending conversion value.\n\n\nCode\nconv_paths |&gt;\n  slice_max(order_by = value, n = 10) |&gt; \n  datatable(options = list(dom = \"t\"))\n\n\n\n\n\n\n\nIt looks like there are some “power” paths that provide massive part of the conversions / value.\nGiven the insights from the country/medium analysis - it’s not surprising that the single referral touchpoint is right at the top - with other paths where referral plays a role being also in the top 10.\nSeeing also (none) and cpc in the top 10 makes me more curious about the Markov Model - I expect them to gain on importance in that overall view (as compared to the last non-direct view of the country/medium file).\nOne more thing I would like to check is the relationship of (conversion, value) pairs.\nI will start with a simple scatterplot of their relationship.\n\n\nCode\n# how do conversions-value pairs look like ?\nggplot(conv_paths, aes(conversions, value)) + geom_point()\n\n\n\n\n\nNot entirely sure what to think of this big hole in the middle, at first glance it looks bit unrealistic ?\nWondering if some scale-changes would show something ? Will try to log both axis\n\n\nCode\nggplot(conv_paths, aes(conversions, value)) +\n  geom_point() +\n  scale_x_log10() +\n  scale_y_log10()\n\n\nWarning: Transformation introduced infinite values in continuous y-axis\n\n\n\n\n\nHm, ok … what catches the attention is the last warning about infinite values. This indicates that there are 0 value conversions ?\n\n\nCode\nconv_paths |&gt;\n  filter(value &lt; 1) |&gt; \n  datatable(options = list(dom = \"t\"))\n\n\n\n\n\n\n\nYes that is the case indeed … not sure if this is a “hiccup” in the data / export ?\nWhat percentage of the rows have 0 value ?\n\n\nCode\nconv_paths |&gt;\n  count(value == 0) |&gt;\n  mutate(perc = n / sum(n))\n\n\n# A tibble: 2 × 3\n  `value == 0`     n   perc\n  &lt;lgl&gt;        &lt;int&gt;  &lt;dbl&gt;\n1 FALSE        35743 0.957 \n2 TRUE          1589 0.0426\n\n\nabout 4% of the rows are 0 value. How about in terms of conversions - what % of the conversions (which are all &gt;= 1) have 0 value ?\n\n\nCode\nconv_paths |&gt;\n  group_by(value == 0) |&gt;\n  summarise(n = sum(conversions)) |&gt;\n  mutate(perc = n / sum(n))\n\n\n# A tibble: 2 × 3\n  `value == 0`       n    perc\n  &lt;lgl&gt;          &lt;int&gt;   &lt;dbl&gt;\n1 FALSE        1356737 0.999  \n2 TRUE            1617 0.00119\n\n\nSince it’s only 4% of the data and 0.12% in terms of conversions then i think it’s safe to simply remove these rows. It does not make sense to me to have conversion = 1 & value = 0 - perhaps it’s a cancellation ? In any case it shouldn’t cause any problems I assume.\n\n\nCode\nconv_paths &lt;- conv_paths |&gt; filter(value &gt; 0)"
  },
  {
    "objectID": "conversion_paths.html#what-are-all-possible-mediums-represented",
    "href": "conversion_paths.html#what-are-all-possible-mediums-represented",
    "title": "Conversion paths",
    "section": "What are all possible mediums represented ?",
    "text": "What are all possible mediums represented ?\nLast thing i would like to check all the different mediums reprensented in this data export\n\n\nCode\nmediums &lt;- conv_paths |&gt;\n  select(medium_path) |&gt;\n  separate_wider_delim(\n    medium_path,\n    delim = \" &gt; \",\n    too_few = \"align_start\",\n    names_sep = \"_\"\n  )\n\nmediums |&gt; map(unique)|&gt; flatten_chr() |&gt; unique() |&gt; sort()\n\n\n [1] \"(none)\"               \"(not set)\"            \"ads\"                 \n [4] \"affiliate\"            \"app\"                  \"article\"             \n [7] \"banner\"               \"browser-notification\" \"button\"              \n[10] \"channel\"              \"company_profile\"      \"cpc\"                 \n[13] \"Customer Service\"     \"Customer+Service\"     \"display\"             \n[16] \"email\"                \"feed\"                 \"mailing_gui\"         \n[19] \"metasearch_api\"       \"mobile-notification\"  \"navbar\"              \n[22] \"organic\"              \"paid-social\"          \"peoplebasedmarketing\"\n[25] \"ppd\"                  \"promocode\"            \"referral\"            \n[28] \"s-cpm\"                \"search-banner\"        \"slack\"               \n[31] \"social\"               \"Social\"               \"social-media\"        \n[34] \"stories_banner\"       \"test\"                 \"tram\"                \n[37] \"website\"              \"whitelabel\"           \"youtube\"             \n[40] \"zalo\"                \n\n\nFrom a first look it looks like the same mediums as in the country/medium file, nothing super interesting here."
  },
  {
    "objectID": "conversion_paths.html#in-terms-of-number-of-steps",
    "href": "conversion_paths.html#in-terms-of-number-of-steps",
    "title": "Conversion paths",
    "section": "In terms of number of steps",
    "text": "In terms of number of steps\nHow does the distribution of path lengths look like ?\n\n\nCode\npath_lengths &lt;- conv_paths |&gt;\n  mutate(\n    path_splits = str_split(medium_path, \" &gt; \"),\n    path_length = map_int(path_splits, length),\n    first_touchpoint_medium = map_chr(path_splits, first)\n  ) |&gt; \n  select(path_length, first_touchpoint_medium, value)\n\nggplot(path_lengths, aes(path_length)) + geom_histogram(binwidth = 1)\n\n\n\n\n\nIt’s heavily right skewed with extremely long path lengths - apparently conversion paths of &gt; 100 steps are also possible, although very unlikely. I want to zoom in around the peak of the distribution and see where it lies.\n\n\nCode\nggplot(path_lengths, aes(path_length)) +\n  geom_histogram(binwidth = 1) +\n  xlim(0, 50)\n\n\n\n\n\nIt is centered somewhere around 7-9.\nHow does the right end of the distribution look like ?\n\n\nCode\nquantile(path_lengths$path_length, probs = seq(0.50, 1.00, 0.05))\n\n\n 50%  55%  60%  65%  70%  75%  80%  85%  90%  95% 100% \n  10   11   12   13   14   16   18   21   26   36  364 \n\n\n\nhalf of the conversions take &lt;= 10 touchpoints to convert\n90% of the conversions take &lt;= 26 touchpoints to convert"
  },
  {
    "objectID": "conversion_paths.html#in-terms-of-value",
    "href": "conversion_paths.html#in-terms-of-value",
    "title": "Conversion paths",
    "section": "In terms of value",
    "text": "In terms of value\nIn terms of number of steps - the most common paths are 7-9 steps long, but how about in terms of value ? What are the path lengths that bring the most monetary value and are these the same ?\n\n\nCode\npath_lengths |&gt; \n  group_by(path_length) |&gt; \n  summarise(value = sum(value)) |&gt; \n  filter(path_length &lt;= 15) |&gt; \n  ggplot(aes(x = as.factor(path_length), y = value)) +\n  geom_col() +\n  scale_y_continuous(labels = label_comma(prefix = \"€\")) +\n  labs(\n    x = \"Path length\",\n    y = NULL,\n    title = \"Monetary value brought by the different path lengths\"\n  ) +\n  theme(\n    plot.title.position = \"plot\"\n  )\n\n\n\n\n\nIt seems like the path length is highly (negatively) correlated with the value it brings i.e. the longer the path - the less value we expect it to bring. I guess this makes sense ? I imagine a highly “unsure” customer that is hesitating and keeps “prolonging” the customer journey vs. a determined or decisive customer whose journey is more focused ( on the other hand i wonder if this is not always the case for every industry and business ?).\nWhat % of the value is brought by path lengths of &lt;= 10 ?\n\n\nCode\npath_lengths |&gt; \n  group_by(path_length) |&gt; \n  summarise(value = sum(value)) |&gt; \n  mutate(\n    perc = value / sum(value),\n    cumul = cumsum(perc),\n    across(c(perc, cumul), percent_format(accuracy = 0.1))\n  ) |&gt; \n  datatable()\n\n\n\n\n\n\n\n~95% of the value is already brought by path lengths of &lt;= 5 !\nIn any case - this view could be useful in some marketing optimisations i.e. if we would be able to determine the already-existing path length of a customer - then we could increase or decrease or marketing spend in order to nudge the customer or to save some costs (if we would be able to determing the customers whose journey already overstepped e.g. path length of 6 then we could chose to save these costs or re-invest them in remarketing to customers who are still at step 2 or 3 - as we know that small % of the value comes past this threshold)."
  },
  {
    "objectID": "conversion_paths.html#most-common-first-medium",
    "href": "conversion_paths.html#most-common-first-medium",
    "title": "Conversion paths",
    "section": "Most common first medium",
    "text": "Most common first medium\nWhat is the most common first medium ? This one I picked out of curiosity to see how does the usual customer journey starts.\n\n\nCode\npath_lengths |&gt;\n  count(first_touchpoint_medium, sort = T) |&gt;\n  mutate(perc = percent_format(accuracy = 0.001)(n / sum(n)))\n\n\n# A tibble: 23 × 3\n   first_touchpoint_medium     n perc   \n   &lt;chr&gt;                   &lt;int&gt; &lt;chr&gt;  \n 1 referral                15371 43.004%\n 2 (none)                   9703 27.147%\n 3 cpc                      6511 18.216%\n 4 organic                  2282 6.384% \n 5 email                     869 2.431% \n 6 tram                      590 1.651% \n 7 (not set)                 269 0.753% \n 8 s-cpm                      47 0.131% \n 9 search-banner              44 0.123% \n10 button                     12 0.034% \n# ℹ 13 more rows\n\n\nAgain perhaps unsurprisingly as I saw in the country/medium analysis - referral is the 1st touchpoint for people ~45% of the time being the “power” medium drivers of customers - with (none) and cpc following behind.\nAre there any duplicate rows in the data ?\n\n\nCode\nconv_paths$medium_path |&gt; duplicated() |&gt; sum()\n\n\n[1] 4743\n\n\nyes, so this means i have multiple rows with same medium path and different conversions and values, so I need to re-group-and-summarise by medium path the duplicates.\n\n\nCode\nconv_paths &lt;- conv_paths |&gt;\n  group_by(medium_path) |&gt;\n  summarise(across(c(conversions, value), sum)) |&gt;\n  ungroup()\n\n\nAt this point I am content with the checks, cleaning and format of the file."
  },
  {
    "objectID": "conversion_paths.html#transition-matrix",
    "href": "conversion_paths.html#transition-matrix",
    "title": "Conversion paths",
    "section": "Transition Matrix",
    "text": "Transition Matrix\nSelect only the top 10 to de-clutter the network\n\n\nCode\ntop_mediums &lt;- markov_mod$result |&gt; \n  slice_max(order_by = total_conversions, n = 11)\n\n\n\n\nCode\n# channel index &lt;-&gt; name\nchannel_index_to_name &lt;- markov_mod$result |&gt;\n  as_tibble() |&gt;\n  select(channel_name) |&gt;\n  rownames_to_column(\"channel_index\") |&gt;\n  deframe()\n\n\ntransition_matrix &lt;- markov_mod$transition_matrix |&gt;\n  as_tibble() |&gt;\n  mutate(\n    channel_from = ifelse(\n      channel_from %in% c(\"(start)\", \"(conversion)\"),\n      channel_from,\n      channel_index_to_name[ channel_from ]\n    ),\n    channel_to = ifelse(\n      channel_to %in% c(\"(start)\", \"(conversion)\"),\n      channel_to,\n      channel_index_to_name[ channel_to ]\n    )\n  ) |&gt; \n  semi_join(\n    top_mediums,\n    join_by(channel_from == channel_name)\n  ) |&gt; \n  group_by(channel_from) |&gt; \n  slice_max(order_by = transition_probability, n = 4, with_ties = F) |&gt; \n  ungroup()\n\n\n\nHeatmap\n\n\nCode\ntransition_matrix |&gt; \n  ggplot(aes(x = channel_from, y = channel_to, fill = transition_probability)) +\n  geom_tile() +\n  geom_label(\n    aes(label = percent_format(accuracy = 0.1)(transition_probability)),\n    label.size = NA,\n    alpha = 0.5,\n    size = 3.4\n  ) +\n  scale_fill_gradient(\n    low = \"tomato2\",\n    high = \"olivedrab3\",\n    na.value = \"cornsilk4\"\n  ) +\n  coord_flip() +\n  labs(x = \"From\", y = \"To\") +\n  theme_minimal() +\n  theme(\n    panel.grid.major = element_blank(),\n    panel.grid.minor = element_blank(),\n    legend.position = \"bottom\",\n    legend.direction = \"horizontal\"\n  )\n\n\n\n\n\n\nConclusions from this part\n(N.B. the rows do not sum up to 1 because i trimmed some channels with very small transition probabilities in order to keep the network de-cluttered).\nAs suspected - quite some interesting and different views on customer conversions from this side.\n\nTo end up in the (conversion) state, the highest transition probability 82.6% is coming from (none). This means that - given that you had a direct click (or visit coming in directly by typing the website) - then the most likely thing that you will do next is to actually convert\n\nCompare this with 68.8% coming from referral - this means that if your last click was referral then you h\n\nthis is in contrast to the country/medium view where referral was always dominating the shares\n\nto restate it bit differently\n\nthere is a 1 in 1.21 chance that you will convert - if your last click was direct.\nthere is a 1 in 1.45 chance that you will convert - if your last click was referral\nso having a direct click increases your chances by 20% to convert\n\n\nfrom an organic state - it’s more likely that the path continues to a cpc or (none) than to a (conversion)\n\norganic is an important middle-step in the customer journey that feeds the other mediums\n\nalso conversely, crossing a cpc paid search touchpoint is most likely coming from an organic search\n\nafter having organic search click - people do click on paid search ads\nthought/wonder - had the website converted them better at the organic search step - there would be no need to pay for the paid search ad, hence optimising the marketing spend ?\n\nafter referral one wold most likely either convert or continue to a (none) touch\n\nfollowing the referral click, people either convert or go on to visit the client directly - which probably means that they will most likely convert as the transition direct -&gt; conversion is the highest\n\nin order to confirm this we need to look at the order-2 markov model and the transition probability of referral -&gt; direct -&gt; conversion\n\n\n\n\n\n\nGraph\nI found it a bit difficult to find an appropriate graph size and layout in order to be able to easily draw conclusions or see patterns and cliques in the data. It’s a pity that it just looks nice but it’s not super useful for most practical problems.\n\n\nCode\nlibrary(\"igraph\")\n\ntop_mediums &lt;- c(\n  \"(start)\",\n  \"(conversion)\",\n  \"(none)\",\n  \"(not set)\",\n  \"cpc\",\n  \"email\",\n  \"organic\",\n  \"referral\"\n)\n\ntransition_matrix &lt;- transition_matrix |&gt; \n  filter(\n    channel_from %in% top_mediums,\n    channel_to %in% top_mediums\n  )\n\nnetwork &lt;- graph_from_data_frame(d = transition_matrix, directed = T)\n\nV(network)$color &lt;- case_match(\n  V(network)$name,\n   \"(start)\"       ~ \"darkslategray3\",\n    \"(conversion)\" ~ \"gold3\",\n    \"(none)\"    ~ \"darkolivegreen3\",\n    \"email\"     ~ \"darkolivegreen3\",\n    \"navbar\"    ~ \"darkolivegreen3\",\n    \"organic\"   ~ \"darkolivegreen3\",\n    \"referral\"  ~ \"darkolivegreen3\",\n    \"(not set)\" ~ \"firebrick2\",\n    \"cpc\"       ~ \"firebrick2\",\n    \"s-cpm\"     ~ \"firebrick2\"\n)\n\nplot(\n  network,\n  layout = layout_with_fr,\n  edge.arrow.size = 0.2,\n  edge.curved = F,\n  edge.label = percent_format(accuracy = 0.1)(E(network)$transition_probability)\n)"
  },
  {
    "objectID": "conversion_paths.html#removal-effects",
    "href": "conversion_paths.html#removal-effects",
    "title": "Conversion paths",
    "section": "Removal Effects",
    "text": "Removal Effects\nIt’s important to keep in mind here what the removal effects mean. Imagine a linear conversion path\nemail -&gt; direct -&gt; conversion\nBoth of these channels have 100% removal effect because the conversion would not happen if we remove either of them. That’s why the following removal effects do not sum up to 100%.\n\n\nCode\nmarkov_mod$removal_effects |&gt; \n  as_tibble() |&gt;\n  filter(removal_effects_conversion_value &gt; 0.0) |&gt; \n  arrange(desc(removal_effects_conversion_value)) |&gt; \n  mutate(across(starts_with(\"removal_\"), percent_format(accuracy = 0.01))) |&gt; \n  datatable()\n\n\n\n\n\n\n\n\nreferral is getting over-valued in the country/medium (last non-direct) attribution model where it has the lion’s share of revenue consistently across all countries. even though it’s not the same measure - still the effect according to the Markov model is ~60% whereas it used to be more like ~80% in the country/medium view\n(none)/direct is getting under-valued in the country/medium view, being credited there with only like ~8% of the revenue. In this view it is almost on par actually with referral\n\nso direct is almost the same value as referral - this is a huge change in value perspective (it is not the same value - but nevertheless direct went from getting ~8% of the value to ~54% of the value)\n\ncpc seems to be very close in terms of attribution from both views\nthe order is the same but the % attributed value differs (at least for the top 2 mediums)"
  },
  {
    "objectID": "country_medium.html",
    "href": "country_medium.html",
    "title": "Country / Medium",
    "section": "",
    "text": "In this section I want to look at the data on the granular country/medium level. Roughly, the questions I plan to ask and answer are:\n\nidentify and remove some noise in the data (low or zero volume mediums ?)\nexplore the marketing mix across countries in terms of the main metrics\n\ne.g. which mediums bring the most revenue and is this consisent across countries ?\n\nare there countries with relatively low volume of free traffic - that however converts very well - which could indicate potential for market expansion ?\n\nThe upcoming first section is mostly data exploration and some cleaning steps - feel free to jump straight to the more interesting parts:\n\nExploration of the profiles in terms of medium mix across the different countries\nExploration of high volume free traffic - that is also converting well"
  },
  {
    "objectID": "country_medium.html#filter-out-low-volume-countries",
    "href": "country_medium.html#filter-out-low-volume-countries",
    "title": "Country / Medium",
    "section": "Filter out low volume countries",
    "text": "Filter out low volume countries\nUsing the results from the Country analysis - I decided to filter out some of the low volume countries in terms of # users, transactions and revenue. This should reduce the noise and focus on higher volume and impact markets while keeping our insights actionable.\n\n\nCode\nby_country &lt;- \n  medium_country_raw |&gt; \n  group_by(country) |&gt; \n  summarise(\n    # summable-metrics\n    across(\n      c(users, new_users, sessions, transactions, revenue),\n      sum\n    ),\n    # take means for the rates, shares, durations\n    across(\n      c(bounce_rate, pages_session, avg_session_duration, ecommerce_conversion_rate),\n      mean\n    )\n  ) |&gt; \n  ungroup() |&gt; \n  # calculate new columns\n  mutate(\n    revenue_per_transaction = revenue / transactions,\n    new_users_share = new_users / users,\n  ) |&gt; \n  arrange(desc(revenue))\n\n# filter only bigger volume countries\nby_country &lt;- by_country |&gt; \n  filter((revenue &gt; 20000) | (users &gt; 1000) | (transactions &gt; 100) )\n\n\nRename country-level columns with a suffix, I will stick them to the country-medium data to be able to compute further columns like shares and percentages.\n\n\nCode\nby_country &lt;- by_country |&gt; \n  rename_with(\n    .fn = ~ glue(\"{.x}_country\"),\n    .cols = c(everything(), -country)\n  )\n\nby_country |&gt; head(6) |&gt; datatable(options = list(dom = \"t\"))\n\n\n\n\n\n\n\nSetup a clean dataframe on country / medium level and compute some additional metrics.\n\n\nCode\nmedium_country &lt;- \n  # filtering join on top-volume countries\n  medium_country_raw |&gt; \n  inner_join(by_country, join_by(country)) |&gt; \n  # re-arrange a bit\n  arrange(desc(revenue_country), country, desc(revenue)) |&gt; \n  relocate(country, .before = medium) |&gt; \n  # calculate share of channel within country for main metrics\n  mutate(\n    revenue_share      = revenue       / revenue_country,\n    users_share        = users         / users_country,\n    new_users_share    = new_users     / new_users_country,\n    sessions_share     = sessions      / sessions_country,\n    transactions_share = transactions  / transactions_country\n  ) |&gt; \n  # rank channels within country\n  group_by(country) |&gt; \n  mutate(\n    across(\n      c(users, new_users, sessions, transactions, revenue),\n      .fns = ~ dense_rank(desc(.x)),\n      .names = \"{col}_channel_within_country_rank\"\n    )\n  ) |&gt; \n  ungroup()\n\n\nmedium_country |&gt; filter(country == \"Spain\") |&gt; datatable(options = list(dom = \"t\"))\n\n\n\n\n\n\n\nBesides filtering out the low volume countries, I would like to also filter out the super low volume (country, medium) pairs. In the above table for instance, scrolling to the last page shows pairs like e.g. (Spain, Twitter) , (Spain, sms) which have 1 user and 0 revenue.\nI would like to check the share of such low volume country/medium pairs. Again taking just some kind of cut-off points - I’m going to start with:\nrevenue &lt; 100  or  users &lt; 10  or  transaction &lt; 10\nas a simple rule to filter these out.\n\n\nCode\nmedium_country &lt;- medium_country |&gt; \n  mutate(\n    is_low_volume_medium = {\n      (revenue &lt; 50) & (users &lt; 5) & (transactions  &lt; 5)\n    }\n  ) \n\nmedium_country |&gt; \n  count(is_low_volume_medium) |&gt; \n  mutate(perc = round(n / sum(n), 3)) |&gt; \n  datatable(options = list(dom = 't'))\n\n\n\n\n\n\n\nOk seems like quite a big percentage of the country/medium pairs are actually low volume i.e. have less than 10 users, 10 transactions and 100 revenue. This seems quite a low benchmark so removing them seems the correct way to go because their contribution and impact is very limited.\nIn order to see the effect of this - I would like to check the number of mediums per country before and after the removal.\n\n\nCode\nmedium_country |&gt;\n  mutate(is_low_volume_medium = factor(is_low_volume_medium, levels = c(T, F), ordered = T)) |&gt; \n  group_by(country, is_low_volume_medium) |&gt; \n  summarise(n_mediums = n_distinct(medium)) |&gt;\n  mutate(n_mediums_total = sum(n_mediums)) |&gt; \n  ungroup() |&gt; \n  mutate(\n    country = fct_reorder(country, n_mediums_total, sum),\n    country = fct_lump(country, w = n_mediums_total, n = 20, ties.method = \"random\")\n  ) |&gt; \n  filter( country != \"Other\" ) |&gt; \n  ggplot(aes(x = n_mediums, y = country, fill = is_low_volume_medium)) +\n  geom_col() +\n  scale_x_continuous(expand = c(0, 0.1)) +\n  scale_fill_manual(\n    name = \"Is Low Volume Medium ?\",\n    values = c(`FALSE` = \"green4\", `TRUE` = \"red3\")\n  ) +\n  labs(\n    title = \"# of Mediums per Country, coloured by Too Low / Ok volume ?\",\n    x = \"# Mediums\",\n    y = NULL\n  ) +\n  theme(\n    legend.position = \"bottom\",\n    legend.direction = \"horizontal\"\n  )\n\n\n`summarise()` has grouped output by 'country'. You can override using the\n`.groups` argument.\n\n\n\n\n\nIt seems like it would ~halve the # of mediums per country.\n\nRemove low volume mediums\n\n\nCode\nmedium_country &lt;- medium_country |&gt;\n  filter(!is_low_volume_medium) |&gt; \n  select(-is_low_volume_medium)"
  },
  {
    "objectID": "country_medium.html#absolute",
    "href": "country_medium.html#absolute",
    "title": "Country / Medium",
    "section": "Absolute",
    "text": "Absolute\nI am going to stack each country’s bars to the total absolute volume of the respective metric. The different colours of the mediums would add up to the total of the country for that metric in absolute units.\n\nSessionsUsersNew usersTransactionsRevenue\n\n\n\n\nCode\nmedium_country |&gt;\n  semi_join(\n    by_country |&gt; slice_max(order_by = sessions_country, n = 20),\n    join_by(country)\n  ) |&gt;\n  filter(country != \"(not set)\") |&gt;\n  mutate(\n    medium = fct_lump(medium, n = 6, w = sessions),\n    medium = fct_reorder(medium, sessions, max),\n    country = fct_reorder(country, sessions, sum)\n  ) |&gt;\n  ggplot(aes(x = sessions, y = country, fill = medium)) +\n  geom_col(position = \"stack\") +\n  scale_x_continuous(labels = comma_format(), expand = c(0, 0.3)) +\n  scale_fill_brewer(palette = \"Dark2\", direction = 1) +\n  theme(\n    plot.title.position = \"plot\",\n    legend.position = \"bottom\"\n  ) +\n  labs(\n    title = \"Sessions contribution of Mediums across Countries\",\n    y = NULL\n  )\n\n\n\n\n\n\n\n\n\nCode\nmedium_country |&gt;\n  semi_join(\n    by_country |&gt; slice_max(order_by = users_country, n = 20),\n    join_by(country)\n  ) |&gt;\n  filter(country != \"(not set)\") |&gt;\n  mutate(\n    medium = fct_lump(medium, n = 6, w = users),\n    medium = fct_reorder(medium, users, mean),\n    country = fct_reorder(country, users, sum)\n  ) |&gt;\n  ggplot(aes(x = users, y = country, fill = medium)) +\n  geom_col(position = \"stack\") +\n  scale_x_continuous(labels = comma_format(), expand = c(0, 0.3)) +\n  scale_fill_brewer(palette = \"Dark2\", direction = 1) +\n  theme(\n    plot.title.position = \"plot\",\n    legend.position = \"bottom\"\n  ) +\n  labs(\n    title = \"Users contribution of Mediums across Countries\",\n    y = NULL\n  )\n\n\n\n\n\n\n\n\n\nCode\nmedium_country |&gt;\n  semi_join(\n    by_country |&gt; slice_max(order_by = new_users_country, n = 20),\n    join_by(country)\n  ) |&gt;\n  filter(country != \"(not set)\") |&gt;\n  mutate(\n    medium = fct_lump(medium, n = 6, w = new_users),\n    medium = fct_reorder(medium, new_users, mean),\n    country = fct_reorder(country, new_users, sum)\n  ) |&gt;\n  ggplot(aes(x = new_users, y = country, fill = medium)) +\n  geom_col(position = \"stack\") +\n  scale_x_continuous(labels = comma_format(), expand = c(0, 0.3)) +\n  scale_fill_brewer(palette = \"Dark2\", direction = 1) +\n  theme(\n    plot.title.position = \"plot\",\n    legend.position = \"bottom\"\n  ) +\n  labs(\n    title = \"New Users contribution of Mediums across Countries\",\n    y = NULL\n  )\n\n\n\n\n\n\n\n\n\nCode\nmedium_country |&gt;\n  semi_join(\n    by_country |&gt; slice_max(order_by = transactions_country, n = 20),\n    join_by(country)\n  ) |&gt;\n  filter(country != \"(not set)\") |&gt;\n  mutate(\n    medium = fct_lump(medium, n = 6, w = transactions),\n    medium = fct_reorder(medium, transactions, mean),\n    country = fct_reorder(country, transactions, sum)\n  ) |&gt;\n  ggplot(aes(x = transactions, y = country, fill = medium)) +\n  geom_col(position = \"stack\") +\n  scale_x_continuous(labels = comma_format(), expand = c(0, 0.3)) +\n  scale_fill_brewer(palette = \"Dark2\", direction = 1) +\n  theme(\n    plot.title.position = \"plot\",\n    legend.position = \"bottom\"\n  ) +\n  labs(\n    title = \"Transactions contribution of Mediums across Countries\",\n    y = NULL\n  )\n\n\n\n\n\n\n\n\n\nCode\nmedium_country |&gt;\n  semi_join(\n    by_country |&gt; slice_max(order_by = revenue_country, n = 20),\n    join_by(country)\n  ) |&gt;\n  filter(country != \"(not set)\") |&gt;\n  mutate(\n    medium = fct_lump(medium, n = 6, w = revenue),\n    medium = fct_reorder(medium, revenue, mean),\n    country = fct_reorder(country, revenue, sum)\n  ) |&gt;\n  ggplot(aes(x = revenue, y = country, fill = medium)) +\n  geom_col(position = \"stack\") +\n  scale_x_continuous(labels = comma_format(), expand = c(0, 0.3)) +\n  scale_fill_brewer(palette = \"Dark2\", direction = 1) +\n  theme(\n    plot.title.position = \"plot\",\n    legend.position = \"bottom\"\n  ) +\n  labs(\n    title = \"Revenue contribution of Mediums across Countries\",\n    y = NULL\n  )"
  },
  {
    "objectID": "country_medium.html#share",
    "href": "country_medium.html#share",
    "title": "Country / Medium",
    "section": "Share",
    "text": "Share\nHere i want to stack each country’s bars to 100% of the respective metric. The different colours of the mediums would represent the share in % that this medium contributed to the 100% for that metric and for that country.\n\nSessionsUsersNew usersTransactionsRevenue\n\n\n\n\nCode\nmedium_country |&gt;\n  semi_join(\n    by_country |&gt; slice_max(order_by = sessions_country, n = 20),\n    join_by(country)\n  ) |&gt;\n  filter(country != \"(not set)\") |&gt;\n  mutate(\n    medium = fct_lump(medium, n = 6, w = sessions_share),\n    medium = fct_reorder(medium, sessions_share, max),\n    country = fct_reorder(country, sessions, sum)\n  ) |&gt;\n  ggplot(aes(x = sessions_share, y = country, fill = medium)) +\n  geom_col(position = \"stack\") +\n  scale_x_continuous(labels = percent_format(), expand = c(0, 0)) +\n  scale_fill_brewer(palette = \"Dark2\", direction = 1) +\n  theme(legend.position = \"bottom\") +\n  labs(\n    title = \"Sessions share per Medium across Countries\",\n    y = NULL\n  )\n\n\n\n\n\n\n\n\n\nCode\nmedium_country |&gt;\n  semi_join(\n    by_country |&gt; slice_max(order_by = users_country, n = 20),\n    join_by(country)\n  ) |&gt;\n  filter(country != \"(not set)\") |&gt;\n  mutate(\n    medium = fct_lump(medium, n = 6, w = users_share),\n    medium = fct_reorder(medium, users_share, max),\n    country = fct_reorder(country, users, sum)\n  ) |&gt;\n  ggplot(aes(x = users_share, y = country, fill = medium)) +\n  geom_col(position = \"stack\") +\n  scale_x_continuous(labels = percent_format(), expand = c(0, 0)) +\n  scale_fill_brewer(palette = \"Dark2\", direction = 1) +\n  theme(legend.position = \"bottom\") +\n  labs(\n    title = \"Users share per Medium across Countries\",\n    y = NULL\n  )\n\n\n\n\n\n\n\n\n\nCode\nmedium_country |&gt;\n  semi_join(\n    by_country |&gt; slice_max(order_by = new_users_country, n = 20),\n    join_by(country)\n  ) |&gt;\n  filter(country != \"(not set)\") |&gt;\n  mutate(\n    medium = fct_lump(medium, n = 6, w = new_users_share),\n    medium = fct_reorder(medium, new_users_share, max),\n    country = fct_reorder(country, new_users, sum)\n  ) |&gt;\n  ggplot(aes(x = new_users_share, y = country, fill = medium)) +\n  geom_col(position = \"stack\") +\n  scale_x_continuous(labels = percent_format(), expand = c(0, 0)) +\n  scale_fill_brewer(palette = \"Dark2\", direction = 1) +\n  theme(legend.position = \"bottom\") +\n  labs(\n    title = \"New Users share per Medium across Countries\",\n    y = NULL\n  )\n\n\n\n\n\n\n\n\n\nCode\nmedium_country |&gt;\n  semi_join(\n    by_country |&gt; slice_max(order_by = transactions_country, n = 20),\n    join_by(country)\n  ) |&gt;\n  filter(country != \"(not set)\") |&gt;\n  mutate(\n    medium = fct_lump(medium, n = 6, w = transactions_share),\n    medium = fct_reorder(medium, transactions_share, max),\n    country = fct_reorder(country, transactions, sum)\n  ) |&gt;\n  ggplot(aes(x = transactions_share, y = country, fill = medium)) +\n  geom_col(position = \"stack\") +\n  scale_x_continuous(labels = percent_format(), expand = c(0, 0)) +\n  scale_fill_brewer(palette = \"Dark2\", direction = 1) +\n  theme(legend.position = \"bottom\") +\n  labs(\n    title = \"Transactions share per Medium across Countries\",\n    y = NULL\n  )\n\n\n\n\n\n\n\n\n\nCode\nmedium_country |&gt;\n  semi_join(\n    by_country |&gt; slice_max(order_by = revenue_country, n = 20),\n    join_by(country)\n  ) |&gt;\n  filter(country != \"(not set)\") |&gt;\n  mutate(\n    medium = fct_lump(medium, n = 6, w = revenue_share),\n    medium = fct_reorder(medium, revenue_share, mean),\n    country = fct_reorder(country, revenue, sum)\n  ) |&gt;\n  ggplot(aes(x = revenue_share, y = country, fill = medium)) +\n  geom_col(position = \"stack\") +\n  scale_x_continuous(labels = percent_format(), expand = c(0, 0)) +\n  scale_fill_brewer(palette = \"Dark2\", direction = 1) +\n  theme(\n    plot.title.position = \"plot\",\n    legend.position = \"bottom\"\n  ) +\n  labs(\n    title = \"Revenue share per Medium across Countries\",\n    y = NULL\n  )"
  },
  {
    "objectID": "country_medium.html#table-of-medians",
    "href": "country_medium.html#table-of-medians",
    "title": "Country / Medium",
    "section": "Table of medians",
    "text": "Table of medians\nTabulated view of the median values for each medium - of the respective metric’s country share e.g. the median for referral’s transaction_share across all countries. Should give an idea of where this medium sits in the overall ranking of mediums across all countries.\n\n\nCode\nsessions_share_medians &lt;- medium_country |&gt;\n  semi_join(\n    by_country |&gt; slice_max(order_by = sessions_country, n = 20),\n    join_by(country)\n  ) |&gt; \n  group_by(medium) |&gt; \n  summarise(median_sessions_share = median(sessions_share)) |&gt;\n  slice_max(order_by = median_sessions_share, n = 20) |&gt; \n  mutate(median_sessions_share = percent_format(accuracy = 0.01)(median_sessions_share))\n\n\nusers_share_medians &lt;- medium_country |&gt;\n  semi_join(\n    by_country |&gt; slice_max(order_by = users_country, n = 20),\n    join_by(country)\n  ) |&gt; \n  group_by(medium) |&gt; \n  summarise(median_users_share = median(users_share)) |&gt;\n  slice_max(order_by = median_users_share, n = 20) |&gt; \n  mutate(median_users_share = percent_format(accuracy = 0.01)(median_users_share))\n\n\nnew_users_share_medians &lt;- medium_country |&gt;\n  semi_join(\n    by_country |&gt; slice_max(order_by = new_users_country, n = 20),\n    join_by(country)\n  ) |&gt; \n  group_by(medium) |&gt; \n  summarise(median_new_users_share = median(new_users_share)) |&gt;\n  slice_max(order_by = median_new_users_share, n = 20) |&gt; \n  mutate(median_new_users_share = percent_format(accuracy = 0.01)(median_new_users_share))\n\ntransactions_share_medians &lt;- medium_country |&gt;\n  semi_join(\n    by_country |&gt; slice_max(order_by = transactions_country, n = 20),\n    join_by(country)\n  ) |&gt; \n  group_by(medium) |&gt; \n  summarise(median_transactions_share = median(transactions_share)) |&gt;\n  slice_max(order_by = median_transactions_share, n = 20) |&gt; \n  mutate(median_transactions_share = percent_format(accuracy = 0.01)(median_transactions_share))\n\n\nrevenue_share_medians &lt;- medium_country |&gt;\n  semi_join(\n    by_country |&gt; slice_max(order_by = revenue_country, n = 20),\n    join_by(country)\n  ) |&gt; \n  group_by(medium) |&gt; \n  summarise(median_revenue_share = median(revenue_share)) |&gt;\n  slice_max(order_by = median_revenue_share, n = 20) |&gt; \n  mutate(median_revenue_share = percent_format(accuracy = 0.01)(median_revenue_share))\n\ncountry_medium_view &lt;- \n  list(\n    sessions_share_medians,\n    users_share_medians,\n    new_users_share_medians,\n    transactions_share_medians,\n    revenue_share_medians\n  ) |&gt; \n  reduce(left_join, by = join_by(medium))\n\ndatatable(country_medium_view)"
  },
  {
    "objectID": "country_medium.html#conclusions-country-medium-profiles",
    "href": "country_medium.html#conclusions-country-medium-profiles",
    "title": "Country / Medium",
    "section": "Conclusions Country Medium Profiles",
    "text": "Conclusions Country Medium Profiles\n\nreferral seems to be consistently the dominating medium across countries, driving ~45% of sessions / (new) users and ~75% of transactions and revenue\n(none) is on the 2nd place, driving ~26% of sessions and (new) users, ~ 8% of transactions and revenue\ncpc is on the 3rd place, driving ~11% of sessions and (new) users, ~8% of transactions and revenue\norganic has slightly worse new users share median when compared to users share median i.e. it is not so good medium when it comes to bringing new users to the website.\n\nTaking referral, (none), organic, email as free mediums - they jointly would contribute with ~75% of the traffic and ~85% of transactions and revenue overall. The “free” group of mediums in the medium-mix of the client are responsiblie for a big portion of the traffic and business - which is a good thing - in the sense that no (or little) marketing money is spent in order to generate this.\nN.B. Probably not entirely true as paid brand marketing would likely highly influcence the organic traffic, as well as email is not completely free - there are at least some operational as well (likely high) licensing costs to partner with an email sending provider that can enable for high scale email sendout campaigns.\nNevertheless, I believe the conclusion remains that basically a big share of the website traffic pie is brought by mostly free mediums."
  },
  {
    "objectID": "country_medium.html#conclusions-high-volume-free-traffic",
    "href": "country_medium.html#conclusions-high-volume-free-traffic",
    "title": "Country / Medium",
    "section": "Conclusions High volume free traffic",
    "text": "Conclusions High volume free traffic\n\nDenmark was often in the top countries in terms of sessions, revenue etc. and it is also on this list. However the surrounding Scandinavian countries like Finland and Norway were not in the top lists - but they do show up in this list. This could mean that there is some kind of “spill-over effect / cross-polination” going on and they could be potential candidates for boosting marketing in them\nThe top 3 candidate countries with the best conv.rate of the free traffic are Ireland, Saudi Arabia and Thailand\nExcluding Denmark - we have Lithuania, Switzerland and Austria as the top 3 countries in this list with the most number of free sessions (yet not best conv.rate of it)\n\nCombining these into one general list would give: Finland, Norway, Ireland, Saudi Arabia, Thailand, Lithuania, Switzerland, Austria - these are good candidate countries for marketing investments because - while having low amounts of paid traffic, they do bring in good amounts of free traffic and they convert this free traffic very well."
  },
  {
    "objectID": "country_medium.html#revenue-per-transaction-for-each-medium",
    "href": "country_medium.html#revenue-per-transaction-for-each-medium",
    "title": "Country / Medium",
    "section": "Revenue per transaction for each medium",
    "text": "Revenue per transaction for each medium\nLastly I would like to look at the derived metric revenue_per_transaction - which is simply the revenue divided by the number of transactions for each country, medium pair (excluding the ones that have zeros in either).\nThe question that I would like to answer is - does the above general picture still hold when looking at this metric - or would there be any differences ? Mostly - is there any medium that is either close or even better than referral - and if so, then it would mean that it should be likely scaled, because the customers coming from such a medium are more valuable.\nIn order to estimate the average revenue per transaction for each medium - I will pull 10,000 bootstrap resamples from the data (stratified by medium to make sure the resamples are representative of the overlying true distribution in the general sample) and I will calculate the average revenue per transaction for each sample. I could then plot the 05th - 50th - 95th percentile of the distribution of average revenue per transaction in order to see if these whiskers highly overlap each other.\n\nBootstrap meansReferral vs. Organic - test for significance\n\n\n\n\nCode\nn_bootstrap_times &lt;- 10000\n\nbootstrap_means &lt;- \n  medium_country |&gt;\n  select(country, medium, revenue, transactions) |&gt;\n  filter(revenue &gt; 0, transactions &gt; 0) |&gt; \n  mutate(revenue_per_transaction = revenue / transactions) |&gt;\n  # lump together some low volume mediums  \n  mutate(\n    medium = fct_lump(medium, n = 7, w = revenue_per_transaction),\n    medium = fct_reorder(medium, revenue_per_transaction, .desc = T)\n  ) |&gt; \n  # bootstrap \n  bootstraps(times = n_bootstrap_times, strata = medium) |&gt; \n  mutate(\n    boot_means = map(splits, ~ {\n      # calculate means grouped by medium\n      as.data.frame(.x) |&gt; \n        group_by(medium) |&gt; \n        summarise(mean_revenue_per_transaction = mean(revenue_per_transaction))\n    })\n  ) |&gt; \n  # explode into long dataframe\n  unnest(boot_means)\n\nbootstrap_means_wide &lt;- bootstrap_means |&gt; \n  # calculate percentiles of distribution\n  group_by(medium) |&gt; \n  reframe(\n    percentile = c(\"05\", \"50\", \"95\"),\n    value = quantile(mean_revenue_per_transaction, probs = c(0.05, 0.50, 0.95))\n  ) |&gt; \n  # flip to better format for plotting\n  pivot_wider(\n    id_cols = medium,\n    names_from = percentile,\n    values_from = value,\n    names_prefix = \"boot_mean_\"\n  )\n\n# Plot\nbootstrap_means_wide |&gt; \n  mutate(medium = fct_reorder(medium, boot_mean_50)) |&gt; \n  ggplot() +\n  geom_point(aes(x = medium, y = boot_mean_05), color = \"dodgerblue4\", size = 3) +\n  geom_point(aes(x = medium, y = boot_mean_50), color = \"dodgerblue3\", size = 3) +\n  geom_point(aes(x = medium, y = boot_mean_95), color = \"dodgerblue4\", size = 3) +\n  geom_segment(\n    aes(x = medium, xend = medium, y = boot_mean_05, yend = boot_mean_95),\n    colour = \"grey60\"\n  ) +\n  scale_y_continuous(\n    breaks = seq(0, 700, 25),\n  ) +\n  coord_flip() +\n  labs(\n    x = NULL,\n    y = \"Mean Revenue per Transaction\",\n    title = \"Bootstrap means for Revenue per Transaction for different Mediums\",\n    subtitle = \"Showing 5th / 50th (median) / 95th percentile for the bootstrapped values for the means\"\n  ) +\n  theme(\n    legend.position = \"none\",\n    plot.title.position = \"plot\"\n    )\n\n\n\n\n\n\n\ntest for signif.difference between referral vs. organic bootstrap distribution of revenue per transaction means\n\n\nCode\nrev_per_trans_referral &lt;- bootstrap_means |&gt; \n  filter(medium == \"referral\") |&gt;\n  pull(mean_revenue_per_transaction)\n\nrev_per_trans_referral_organic &lt;- bootstrap_means |&gt;\n  filter(medium == \"organic\") |&gt;\n  pull(mean_revenue_per_transaction)\n\nt.test(\n  rev_per_trans_referral,\n  rev_per_trans_referral_organic,\n  alternative = \"greater\"\n)\n\n\n\n    Welch Two Sample t-test\n\ndata:  rev_per_trans_referral and rev_per_trans_referral_organic\nt = 192.64, df = 18041, p-value &lt; 2.2e-16\nalternative hypothesis: true difference in means is greater than 0\n95 percent confidence interval:\n 46.05318      Inf\nsample estimates:\nmean of x mean of y \n 451.8508  405.4010 \n\n\n\n\n\nreferral still is the best medium in terms of revenue per transaction. What is interesting I think is that organic jumped over (none), cpc in this view to be close second. This means organic, even though brings less (new) users, they are more valuable on average when compared with these other 2 mediums. Even though organic has whiskers that come close to referral - the t-test shows that those 2 are significantly different means.\nIt would be interesting to compare the average revenue per transaction value for cpc - to the average acquisition cost per customer, in order to come up with a ROI."
  },
  {
    "objectID": "country_medium.html#distribution-of-the-shares-for-each-medium",
    "href": "country_medium.html#distribution-of-the-shares-for-each-medium",
    "title": "Country / Medium",
    "section": "Distribution of the shares for each medium",
    "text": "Distribution of the shares for each medium\nI would like to see the distribution of the revenue shares across all counties, split per medium.\nI got the idea when doing the tabulated view of the medians of shares in the above section and I wanted to answer the question: are there some mediums with wide variance or conversely, if revenue shares are tightly distributed around certain means with little variation ?\nGiven the previously seen table of median revenue shares for mediums across countries - I expect referral’s distribution to be distinctively wide away from “the rest” - but it would be interesting to see e.g. how do (none), cpc, organic compare to each other - or if they even manage to spread out widely as to be competitive in a way to referral ?\n\nUsersNew UsersRevenue\n\n\n\n\nCode\nmedium_country |&gt;\n  semi_join(\n    by_country |&gt; slice_max(order_by = users_country, n = 200),\n    join_by(country)\n  ) |&gt;\n  mutate(\n    medium = fct_lump(medium, n = 6, w = users),\n    medium = fct_reorder(medium, users)\n  ) |&gt;\n  select(country, medium, users, users_country, users_share) |&gt;\n  ggplot(aes(users_share)) +\n  geom_histogram(binwidth = 0.015) +\n  facet_wrap(~ medium, scales = \"free_y\", ncol = 1, strip.position = \"right\")\n\n\n\n\n\n\n\n\n\nCode\nmedium_country |&gt;\n  semi_join(\n    by_country |&gt; slice_max(order_by = new_users_country, n = 200),\n    join_by(country)\n  ) |&gt;\n  mutate(\n    medium = fct_lump(medium, n = 6, w = new_users),\n    medium = fct_reorder(medium, new_users)\n  ) |&gt;\n  select(country, medium, new_users, new_users_country, new_users_share) |&gt;\n  ggplot(aes(new_users_share)) +\n  geom_histogram(binwidth = 0.015) +\n  facet_wrap(~ medium, scales = \"free_y\", ncol = 1, strip.position = \"right\")\n\n\n\n\n\n\n\n\n\nCode\nmedium_country |&gt;\n  semi_join(\n    by_country |&gt; slice_max(order_by = revenue_country, n = 200),\n    join_by(country)\n  ) |&gt;\n  mutate(\n    medium = fct_lump(medium, n = 6, w = revenue),\n    medium = fct_reorder(medium, revenue)\n  ) |&gt;\n  select(country, medium, revenue, revenue_country, revenue_share) |&gt;\n  ggplot(aes(revenue_share)) +\n  geom_histogram(binwidth = 0.015) +\n  facet_wrap(~ medium, scales = \"free_y\", ncol = 1, strip.position = \"right\")\n\n\n\n\n\n\n\n\n\nConclusion distribution of shares\nWhen looking at the revenue shares distributions, indeed referral has by far a distribution mostly centered around the right end of the axis. It’s interesting to see that it seems like it does not overlap at all with any of the (none), cpc, organic distributions i.e. there is no case for our client where one of these channels in a country - contribute as much as referral contributes in the “worst for referral” country. So quite consistent and convincing picture of the marketing medium mix in terms of what works for the client.\nFurthermore - seeing that organic, (none) which I consider free mediums - perform as well as cpc - makes me think that\ncpc performs better than organic in bringing (new) users - yet their revenue shares do not look vastly different.\nQuite obvious is how the distributions for referral, (none), cpc are close in terms of (new) users - but then a striking difference appears when switching the view to revenue. This means that:\n\nreferral brings 50% of the users but 70% of the revenue\n(none) brings 25% of the users but 7% of the revenue\n\nHence, the client does not manage to monetise mediums equally i.e. people coming from (none) usually bring less money than people coming from referral . However - keeping in mind that this is a view from the country_medium.csv file which means that this is the converting session coming from the last non-direct medium. In other words - referral does monetise the incoming users better, however this is not the whole picture as the other mediums might be contributing in other parts of the customer journey on the way to conversion. So it will be interesting to compare this view to the view that will come out of the conversion_paths.csv file i.e. the more general holistic view on the customer journey."
  },
  {
    "objectID": "summary.html",
    "href": "summary.html",
    "title": "Summary",
    "section": "",
    "text": "This section summarises the results from the various sections and ends with some potential actions the client can make in order to boost their marketing presence in various countries and hence expand their business.\n\n\nExploring the medium mix across countries showed that the majority of the revenue/transactions/traffic of the website is brought in by free mediums. Here referral is consistently the top contributing medium (~75% of transactions) across all of the top countries with (none)/direct being 2nd (~ 8% of transactions) and cpc being 3rd (~ 8% of transactions).\nreferral brings in the most valuable customers as well. organic, even though brings less (new) users, they are more valuable on average when compared with direct and cpc.\nThe free group of mediums being the top contributors to business is a good thing - because no (or little) marketing money is spent in order to generate this (at least in this view).\nFor more details please see this section.\n\n\nHaving the possibility to model the whole paths that lead to a conversion lead to interesting differing view on this i.e. referral while still being one of the most important channels, does get over-valued in the last-non-direct-click view. (none)/direct on the other hand gets a boost in importance when considering the conversion paths holistically i.e. it is as important channel as referral in the Markov model view.\nThe one big general takeaway from the whole section here is the importance of testing, comparing and using different models and ways of attributing value to different touchpoints in a journey. None of these models tells the whole truth on their own and it is important to triangulate the truth by using various models and ways to inspect the truth.\nThe results from this model suggest that the last non-direct model from GA could be too limited for this client and that a multi-touch attribution could make sense to explore and implement.\nFor more details please see: transition matrix, removal effects and heuristic vs. markov.\n\n\n\n\n\n\n\n\n\nFinland, Norway, Ireland, Saudi Arabia, Thailand, Lithuania, Switzerland, Austria - these are good candidate countries for marketing investments because - while having low amounts of paid traffic, they do bring in good amounts of free traffic and they convert this free traffic very well.\nFor more details please see this section.\n\n\n\nCountries that convert traffic and have high revenue per transaction are very valuable. Examples of such countries are Japan and New Zealand (amongst the best ones, for others see the section)\nFor more details please see this section.\n\n\n\nLooking at the data at an aggregated country level in terms of market penetration, making some high-level, but bold, assumptions about the current state and the marketing playbook used in certain European countries - it could be that by using the same marketing tactics as in countries like Italy and Spain - the client could potentially achieve higher market presence and therefore higher revenue in countries like France and Germany.\nFor more details please see this section.\n\n\n\n\nPutting these different views together - I compiled a list of potential countries where the client could consider scaling their marketing investment. In order to do a final tally - which should serve as potential guide as to where to start first - I did a simple list with scores of each country as to how many times appears in the different views.\n\n\n\n\n\n\n\nSaudi Arabia, Austria and Netherlands are candidate countries that appear in 2 of the 3 views and hence could be a good starting point for scaling marketing investments.\nThey are all countries where free traffic is already converting well while paid traffic is low - which means the client is likely not doing any paid marketing. So boosting marketing investments in these countries could likely mean also good returns. They are also countries with a high revenue per transaction and hence the customers are above-average-valuable.\nN.B. The columns from the table are linked to the above sections - for more details and what they mean see:\n\ngood_converting_low_free_traffic is explained in Good converting free traffic\ngood_conversion_and_high_value is explained in Good conversion rate and high value\npotential_marketing_scaling is explained in Market Penetration"
  },
  {
    "objectID": "summary.html#mediums-view",
    "href": "summary.html#mediums-view",
    "title": "Summary",
    "section": "",
    "text": "Exploring the medium mix across countries showed that the majority of the revenue/transactions/traffic of the website is brought in by free mediums. Here referral is consistently the top contributing medium (~75% of transactions) across all of the top countries with (none)/direct being 2nd (~ 8% of transactions) and cpc being 3rd (~ 8% of transactions).\nreferral brings in the most valuable customers as well. organic, even though brings less (new) users, they are more valuable on average when compared with direct and cpc.\nThe free group of mediums being the top contributors to business is a good thing - because no (or little) marketing money is spent in order to generate this (at least in this view).\nFor more details please see this section.\n\n\nHaving the possibility to model the whole paths that lead to a conversion lead to interesting differing view on this i.e. referral while still being one of the most important channels, does get over-valued in the last-non-direct-click view. (none)/direct on the other hand gets a boost in importance when considering the conversion paths holistically i.e. it is as important channel as referral in the Markov model view.\nThe one big general takeaway from the whole section here is the importance of testing, comparing and using different models and ways of attributing value to different touchpoints in a journey. None of these models tells the whole truth on their own and it is important to triangulate the truth by using various models and ways to inspect the truth.\nThe results from this model suggest that the last non-direct model from GA could be too limited for this client and that a multi-touch attribution could make sense to explore and implement.\nFor more details please see: transition matrix, removal effects and heuristic vs. markov."
  },
  {
    "objectID": "summary.html#countries-view",
    "href": "summary.html#countries-view",
    "title": "Summary",
    "section": "",
    "text": "Finland, Norway, Ireland, Saudi Arabia, Thailand, Lithuania, Switzerland, Austria - these are good candidate countries for marketing investments because - while having low amounts of paid traffic, they do bring in good amounts of free traffic and they convert this free traffic very well.\nFor more details please see this section.\n\n\n\nCountries that convert traffic and have high revenue per transaction are very valuable. Examples of such countries are Japan and New Zealand (amongst the best ones, for others see the section)\nFor more details please see this section.\n\n\n\nLooking at the data at an aggregated country level in terms of market penetration, making some high-level, but bold, assumptions about the current state and the marketing playbook used in certain European countries - it could be that by using the same marketing tactics as in countries like Italy and Spain - the client could potentially achieve higher market presence and therefore higher revenue in countries like France and Germany.\nFor more details please see this section."
  },
  {
    "objectID": "summary.html#recommendations",
    "href": "summary.html#recommendations",
    "title": "Summary",
    "section": "",
    "text": "Putting these different views together - I compiled a list of potential countries where the client could consider scaling their marketing investment. In order to do a final tally - which should serve as potential guide as to where to start first - I did a simple list with scores of each country as to how many times appears in the different views.\n\n\n\n\n\n\n\nSaudi Arabia, Austria and Netherlands are candidate countries that appear in 2 of the 3 views and hence could be a good starting point for scaling marketing investments.\nThey are all countries where free traffic is already converting well while paid traffic is low - which means the client is likely not doing any paid marketing. So boosting marketing investments in these countries could likely mean also good returns. They are also countries with a high revenue per transaction and hence the customers are above-average-valuable.\nN.B. The columns from the table are linked to the above sections - for more details and what they mean see:\n\ngood_converting_low_free_traffic is explained in Good converting free traffic\ngood_conversion_and_high_value is explained in Good conversion rate and high value\npotential_marketing_scaling is explained in Market Penetration"
  }
]